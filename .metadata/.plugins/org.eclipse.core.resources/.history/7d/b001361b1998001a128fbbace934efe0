/*
 * OutputMenuStateHandler.c
 *
 *  Created on: 15 May 2020
 *      Author: chris
 */

#include "OutputMenuStateHandler.h"

#include "DisplayManager.h"
//#include "SignalManager.h"
#include <stdio.h>



eOutputMenu_Status eNextOutputMenuStatus = 	DISABLE_OUTPUT_MENU;
eOutputSweepModes active_sweep_mode = SWEEP_MODE_UP;

uint16_t min_arr = 128;
uint32_t max_arr = 65535;

#define RATE_COEF	32	// how much the encoder increments/decrements per pulse
#define RATE_DELTA	1.1	// how much we increment/decrement by

eOutputMenu_Status OutputMenu_getStatus()
{
	return eNextOutputMenuStatus;
}

/*
 *
 *	@brief
 *
 *	@param None
 *	@retval None
 *
 */
eSystemState OutputMainMenuEntryHandler()
{
	#ifdef SWV_DEBUG_ENABLED
		printf("OutputMainMenuEntryHandler Event captured\n");
	#endif

	DM_RefreshScreen();

	eNextOutputMenuStatus = ENABLE_OUTPUT_MAIN_MENU;

	// stay in this state
	eNewEvent = evIdle;
	return Output_Main_Menu_State;
}


/*
 *
 *	@brief
 *
 *	@param None
 *	@retval None
 *
 */
eSystemState OutputMainMenuInputHandler()
{
	#ifdef SWV_DEBUG_ENABLED
		printf("OutputMainMenuInputHandler Event captured\n");
	#endif


	return Output_Main_Menu_State;
}

/*
 *
 *	@brief
 *
 *	@param None
 *	@retval None
 *
 */
eSystemState OutputMainMenuExitHandler()
{
	#ifdef SWV_DEBUG_ENABLED
		printf("OutputMainMenuExitHandler Event captured\n");
	#endif


	// disable the menu
	eNextOutputMenuStatus = DISABLE_OUTPUT_MENU;

	// reset the encoder range

	DM_RefreshScreen();

	#ifdef SWV_DEBUG_ENABLED
		  printf("returning to Idle State\n");
	#endif

	eNewEvent = evIdle;
	return Idle_State;
}

/*
 *
 *	@brief
 *
 *	@param None
 *	@retval None
 *
 */
eSystemState OutputPresetMenuEntryHandler()
{
	#ifdef SWV_DEBUG_ENABLED
		printf("OutputPresetMenuEntryHandler Event captured\n");
	#endif

	DM_RefreshScreen();

	eNextOutputMenuStatus = ENABLE_OUTPUT_FUNC_MENU;




	// stay in this state
	eNewEvent = evIdle;
	return Output_Preset_Menu_State;
}


/*
 *
 *	@brief
 *
 *	@param None
 *	@retval None
 *
 */
eSystemState OutputPresetMenuInputHandler()
{
	#ifdef SWV_DEBUG_ENABLED
		printf("OutputPresetMenuInputHandler Event captured\n");
	#endif


	// stay in this state
	eNewEvent = evIdle;
	return Output_Preset_Menu_State;
}

/*
 *
 *	@brief
 *
 *	@param None
 *	@retval None
 *
 */
eSystemState OutputPresetMenuExitHandler()
{
	#ifdef SWV_DEBUG_ENABLED
		printf("OutputPresetMenuExitHandler Event captured\n");
	#endif


	// disable the menu
	eNextOutputMenuStatus = ENABLE_OUTPUT_MAIN_MENU;

	// back to main freq menu
	eNewEvent = evGreenBtn;
	return Idle_State;
}
